{
  "_comment": "This file is generated. Please edit .homeycompose/app.json instead.",
  "id": "solis.modbus",
  "version": "1.0.0",
  "compatibility": ">=12.5.0",
  "sdk": 3,
  "brandColor": "#f68f18",
  "platforms": [
    "local"
  ],
  "name": {
    "en": "Solis TCP modbus"
  },
  "description": {
    "en": "Monitor Solis inverters over TCP modbus protocol"
  },
  "category": [
    "energy"
  ],
  "tags": {
    "en": [
      "solis",
      "inverter",
      "solar",
      "modbus"
    ]
  },
  "bugs": {
    "url": "https://github.com/joakimahlen/solis.modbus/issues"
  },
  "homeyCommunityTopicId": 45487,
  "permissions": [],
  "images": {
    "small": "/assets/images/small.jpg",
    "large": "/assets/images/large.jpg"
  },
  "author": {
    "name": "Joakim Ahlén",
    "email": "joakim.ahlen@gmail.com"
  },
  "contributors": {
    "developers": [
      {
        "name": "Edwin Biemond",
        "email": "biemond@gmail.com"
      }
    ]
  },
  "flow": {
    "triggers": [
      {
        "title": {
          "en": "Force battery charge mode changed"
        },
        "titleFormatted": {
          "en": "Force battery charge mode changed"
        },
        "tokens": [
          {
            "name": "force_battery_charge_mode",
            "type": "string",
            "title": {
              "en": "Force battery charge mode changed"
            },
            "example": "Fault"
          }
        ],
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=solis|soliswithbatt"
          }
        ],
        "id": "changedForceChargeMode"
      },
      {
        "title": {
          "en": "Storage Control Mode changed"
        },
        "titleFormatted": {
          "en": "Storage Control Mode changed"
        },
        "tokens": [
          {
            "name": "storage_control_mode",
            "type": "string",
            "title": {
              "en": "Storage Control Mode changed"
            },
            "example": "Fault"
          }
        ],
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=solis|soliswithbatt"
          }
        ],
        "id": "changedStorageControlMode"
      },
      {
        "title": {
          "en": "The electric current changed"
        },
        "tokens": [
          {
            "name": "measure_current",
            "title": {
              "en": "Current"
            },
            "type": "number",
            "example": 7.5
          }
        ],
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=solis|soliswithbatt"
          }
        ],
        "id": "measure_current_changed"
      },
      {
        "highlight": true,
        "title": {
          "en": "The battery power changed"
        },
        "tokens": [
          {
            "name": "measure_power.batt_power",
            "title": {
              "en": "Power"
            },
            "type": "number",
            "example": 100
          }
        ],
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=soliswithbatt"
          }
        ],
        "id": "measure_power_battery_power_changed"
      },
      {
        "highlight": true,
        "title": {
          "en": "The solar power changed"
        },
        "tokens": [
          {
            "name": "measure_power",
            "title": {
              "en": "Power"
            },
            "type": "number",
            "example": 100
          }
        ],
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=solis|soliswithbatt"
          }
        ],
        "id": "measure_power_changed"
      },
      {
        "highlight": true,
        "title": {
          "en": "The inverter temperature changed"
        },
        "tokens": [
          {
            "name": "measure_temperature.inverter",
            "title": {
              "en": "Temperature"
            },
            "type": "number",
            "example": 23.5
          }
        ],
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=solis|soliswithbatt"
          }
        ],
        "id": "measure_temperature_inverter_changed"
      },
      {
        "title": {
          "en": "Total Yield changed"
        },
        "tokens": [
          {
            "name": "meter_power",
            "title": {
              "en": "Energy"
            },
            "type": "number",
            "example": 25
          }
        ],
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=sollis|soliswithbatt"
          }
        ],
        "id": "meter_power_changed"
      },
      {
        "title": {
          "en": "Total Day Yield changed"
        },
        "tokens": [
          {
            "name": "meter_power.daily",
            "title": {
              "en": "Energy"
            },
            "type": "number",
            "example": 25
          }
        ],
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=solis|soliswithbatt"
          }
        ],
        "id": "meter_power_day_changed"
      }
    ],
    "conditions": [
      {
        "title": {
          "en": "Force battery charge mode is"
        },
        "titleFormatted": {
          "en": "Force battery charge is [[argument_main]]"
        },
        "hint": {
          "en": "The current Force battery charge mode"
        },
        "args": [
          {
            "name": "argument_main",
            "type": "dropdown",
            "values": [
              {
                "id": "-1",
                "title": {
                  "en": "Unknown"
                }
              },
              {
                "id": "0",
                "title": {
                  "en": "Self-use"
                }
              },
              {
                "id": "1",
                "title": {
                  "en": "Peak shaving"
                }
              },
              {
                "id": "2",
                "title": {
                  "en": "Charge"
                }
              },
              {
                "id": "3",
                "title": {
                  "en": "Discharge"
                }
              },
              {
                "id": "4",
                "title": {
                  "en": "Idle"
                }
              }
            ]
          }
        ],
        "id": "force_battery_charge_mode"
      },
      {
        "title": {
          "en": "Storage control mode is"
        },
        "titleFormatted": {
          "en": "Storage control mode is [[argument_main]]"
        },
        "hint": {
          "en": "The current Storage control mode"
        },
        "args": [
          {
            "name": "argument_main",
            "type": "multiselect",
            "conjunction": "and",
            "values": [
              {
                "id": "1",
                "title": {
                  "en": "Self use mode"
                }
              },
              {
                "id": "2",
                "title": {
                  "en": "Time of use mode"
                }
              },
              {
                "id": "4",
                "title": {
                  "en": "Off Grid Mode"
                }
              },
              {
                "id": "8",
                "title": {
                  "en": "Battery wakeup switch"
                }
              },
              {
                "id": "16",
                "title": {
                  "en": "Reserve battery mode"
                }
              },
              {
                "id": "32",
                "title": {
                  "en": "Allow grid to charge battery"
                }
              },
              {
                "id": "64",
                "title": {
                  "en": "Feed in priority"
                }
              },
              {
                "id": "128",
                "title": {
                  "en": "Batt OVC function"
                }
              },
              {
                "id": "256",
                "title": {
                  "en": "Battery force charge peak shaving"
                }
              },
              {
                "id": "512",
                "title": {
                  "en": "Battery correction enable"
                }
              },
              {
                "id": "1024",
                "title": {
                  "en": "Battery healing"
                }
              },
              {
                "id": "2048",
                "title": {
                  "en": "Peak Shaving"
                }
              }
            ]
          }
        ],
        "id": "storage_control_mode"
      }
    ],
    "actions": [
      {
        "title": {
          "en": "Set force battery mode"
        },
        "titleFormatted": {
          "en": "Set force battery mode to [[argument_main]]"
        },
        "args": [
          {
            "name": "argument_main",
            "type": "dropdown",
            "values": [
              {
                "id": "-1",
                "title": {
                  "en": "Unknown"
                }
              },
              {
                "id": "0",
                "title": {
                  "en": "Self-use"
                }
              },
              {
                "id": "1",
                "title": {
                  "en": "Peak shaving"
                }
              },
              {
                "id": "2",
                "title": {
                  "en": "Charge"
                }
              },
              {
                "id": "3",
                "title": {
                  "en": "Discharge"
                }
              },
              {
                "id": "4",
                "title": {
                  "en": "Idle"
                }
              }
            ]
          }
        ],
        "id": "force_battery_charge_mode_main"
      },
      {
        "id": "changedpeak_shaving_max_grid_power",
        "title": {
          "en": "Set peak shaving max grid power"
        },
        "titleFormatted": {
          "en": "Set peak shaving max grid power to [[argument_main]]"
        },
        "args": [
          {
            "type": "number",
            "name": "argument_main",
            "title": {
              "en": "Peak shaving max grid power (W)"
            },
            "placeholder": {
              "en": "1000"
            },
            "min": 0,
            "max": 10000,
            "step": 200
          },
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=solis|soliswithbatt"
          }
        ]
      }
    ]
  },
  "drivers": [
    {
      "name": {
        "en": "Solis Inverter"
      },
      "class": "solarpanel",
      "energy": {
        "batteries": [
          "OTHER"
        ]
      },
      "capabilities": [
        "measure_power",
        "measure_power.grid_phase1",
        "measure_power.grid_phase2",
        "measure_power.grid_phase3",
        "measure_temperature.inverter",
        "meter_power",
        "meter_power.daily",
        "measure_voltage",
        "measure_power.pv",
        "measure_power.pv1",
        "measure_power.pv2",
        "measure_power.pv3",
        "measure_power.pv4",
        "measure_power.house_load",
        "solis_status",
        "solis_model",
        "tou_slots"
      ],
      "capabilitiesOptions": {
        "measure_power": {
          "decimals": 0,
          "title": {
            "en": "Active Power"
          }
        },
        "measure_voltage": {
          "title": {
            "en": "Voltage"
          }
        },
        "measure_power.pv": {
          "title": {
            "en": "PV Power"
          }
        },
        "measure_power.pv1": {
          "title": {
            "en": "PV1 Power"
          }
        },
        "measure_power.pv2": {
          "title": {
            "en": "PV1 Power"
          }
        },
        "measure_power.pv3": {
          "title": {
            "en": "PV1 Power"
          }
        },
        "measure_power.pv4": {
          "title": {
            "en": "PV1 Power"
          }
        },
        "measure_power.house_load": {
          "decimals": 0,
          "title": {
            "en": "House Load Power"
          }
        },
        "measure_temperature.inverter": {
          "title": {
            "en": "Heatsink temperature"
          },
          "decimals": 2
        },
        "meter_power": {
          "title": {
            "en": "Total Yield"
          },
          "decimals": 2
        },
        "meter_power.daily": {
          "title": {
            "en": "Total Day Yield"
          },
          "decimals": 2,
          "icon": "/assets/total_yield.svg"
        },
        "solis_status": {
          "title": {
            "en": "Inverter status"
          },
          "icon": "/assets/operational_status.svg"
        },
        "solis_model": {
          "title": {
            "en": "Inverter model"
          },
          "icon": "/assets/operational_status.svg"
        },
        "tou_slots": {
          "title": {
            "en": "TOU Slots Active"
          }
        }
      },
      "platforms": [
        "local"
      ],
      "connectivity": [
        "lan"
      ],
      "images": {
        "small": "/drivers/solis/assets/images/small.png",
        "large": "/drivers/solis/assets/images/large.png"
      },
      "pair": [
        {
          "id": "start"
        }
      ],
      "settings": [
        {
          "type": "group",
          "label": {
            "en": "Inverter settings"
          },
          "children": [
            {
              "id": "address",
              "type": "text",
              "value": "0.0.0.0",
              "label": {
                "en": "IP Address"
              }
            },
            {
              "id": "port",
              "type": "number",
              "value": 1502,
              "step": 1,
              "label": {
                "en": "Port"
              }
            },
            {
              "id": "id",
              "type": "number",
              "value": 1,
              "step": 1,
              "attr": {
                "min": 0,
                "max": 50
              },
              "label": {
                "en": "Inverter ID"
              }
            }
          ]
        }
      ],
      "id": "solis"
    },
    {
      "name": {
        "en": "Solis Inverter + Battery"
      },
      "class": "solarpanel",
      "energy": {
        "batteries": [
          "OTHER"
        ]
      },
      "capabilities": [
        "battery",
        "measure_battery",
        "measure_current.chargesetting",
        "measure_current.dischargesetting",
        "measure_power",
        "measure_power.batt_power",
        "measure_power.grid_phase1",
        "measure_power.grid_phase2",
        "measure_power.grid_phase3",
        "measure_temperature.inverter",
        "measure_power.pv",
        "measure_power.pv1",
        "measure_power.pv2",
        "measure_power.pv3",
        "measure_power.pv4",
        "measure_power.house_load",
        "meter_power",
        "meter_power.daily",
        "meter_power.grid_export",
        "meter_power.grid_import",
        "meter_power.grid_export_daily",
        "meter_power.grid_import_daily",
        "solis_model",
        "solis_status",
        "force_battery_charge_mode",
        "storage_control_mode",
        "operating_mode",
        "force_charge_source",
        "measure_power.force_charge_limit",
        "measure_power.force_charge_power",
        "measure_power.force_discharge_power",
        "force_charge_direction",
        "measure_power.grid",
        "passive_mode",
        "peak_shaving_max_grid_power",
        "peak_soc"
      ],
      "capabilitiesOptions": {
        "measure_power": {
          "decimals": 0,
          "title": {
            "en": "Active Power"
          }
        },
        "measure_current.chargesetting": {
          "title": {
            "en": "Max Charge Current"
          }
        },
        "measure_current.dischargesetting": {
          "title": {
            "en": "Max Discharge Current"
          }
        },
        "measure_power.pv": {
          "title": {
            "en": "PV Power"
          }
        },
        "measure_power.pv1": {
          "title": {
            "en": "PV1 Power"
          }
        },
        "measure_power.pv2": {
          "title": {
            "en": "PV2 Power"
          }
        },
        "measure_power.pv3": {
          "title": {
            "en": "PV3 Power"
          }
        },
        "measure_power.pv4": {
          "title": {
            "en": "PV4 Power"
          }
        },
        "measure_power.house_load": {
          "decimals": 0,
          "title": {
            "en": "House Load Power"
          }
        },
        "measure_temperature.inverter": {
          "title": {
            "en": "Heatsink temperature"
          },
          "decimals": 2
        },
        "meter_power": {
          "title": {
            "en": "Total Yield"
          },
          "decimals": 2
        },
        "meter_power.daily": {
          "title": {
            "en": "Total Day Yield"
          },
          "decimals": 2,
          "icon": "/assets/total_yield.svg"
        },
        "solis_status": {
          "title": {
            "en": "Inverter status"
          },
          "icon": "/assets/operational_status.svg"
        },
        "solis_model": {
          "title": {
            "en": "Inverter model"
          },
          "icon": "/assets/operational_status.svg"
        },
        "storage_control_mode": {
          "title": {
            "en": "Storage control mode"
          }
        },
        "operating_mode": {
          "title": {
            "en": "Operating mode"
          }
        },
        "force_battery_charge_mode": {
          "title": {
            "en": "Force charge battery"
          }
        },
        "measure_power.force_charge_limit": {
          "title": {
            "en": "Force charge limit"
          }
        },
        "measure_power.force_charge_power": {
          "title": {
            "en": "Force charge power"
          }
        },
        "measure_power.force_discharge_power": {
          "title": {
            "en": "Force discharge power"
          }
        },
        "peak_shaving_max_grid_power": {
          "title": {
            "en": "Peak shaving max grid power"
          }
        },
        "peak_soc": {
          "title": {
            "en": "Peak shaving SOC in percentage (%)"
          }
        },
        "measure_power.grid": {
          "title": {
            "en": "Grid power"
          }
        },
        "force_charge_direction": {
          "title": {
            "en": "Force charge direction"
          }
        },
        "force_charge_source": {
          "title": {
            "en": "Force charge source"
          }
        },
        "passive_mode": {
          "title": {
            "en": "Passive mode"
          }
        },
        "measure_power.batt_power": {
          "decimals": 0,
          "title": {
            "en": "Battery Power"
          }
        },
        "measure_power.grid_phase1": {
          "decimals": 0,
          "title": {
            "en": "Grid Power Phase 1"
          }
        },
        "measure_power.grid_phase2": {
          "decimals": 0,
          "title": {
            "en": "Grid Power Phase 2"
          }
        },
        "measure_power.grid_phase3": {
          "decimals": 0,
          "title": {
            "en": "Grid Power Phase 3"
          }
        },
        "meter_power.grid_import": {
          "title": {
            "en": "Total Grid Import"
          },
          "units": {
            "en": "kWh"
          },
          "decimals": 1,
          "icon": "/assets/total_yield.svg"
        },
        "meter_power.grid_export": {
          "title": {
            "en": "Total Grid Export"
          },
          "units": {
            "en": "kWh"
          },
          "decimals": 1,
          "icon": "/assets/total_yield.svg"
        },
        "meter_power.grid_import_daily": {
          "title": {
            "en": "Grid Import Today"
          },
          "units": {
            "en": "kWh"
          },
          "decimals": 1,
          "icon": "/assets/total_yield.svg"
        },
        "meter_power.grid_export_daily": {
          "title": {
            "en": "Grid Export Today"
          },
          "units": {
            "en": "kWh"
          },
          "decimals": 1,
          "icon": "/assets/total_yield.svg"
        }
      },
      "platforms": [
        "local"
      ],
      "connectivity": [
        "lan"
      ],
      "images": {
        "small": "/drivers/soliswithbatt/assets/images/small.png",
        "large": "/drivers/soliswithbatt/assets/images/large.png"
      },
      "pair": [
        {
          "id": "start"
        }
      ],
      "settings": [
        {
          "type": "group",
          "label": {
            "en": "Inverter settings"
          },
          "children": [
            {
              "id": "address",
              "type": "text",
              "value": "0.0.0.0",
              "label": {
                "en": "IP Address"
              }
            },
            {
              "id": "port",
              "type": "number",
              "value": 1502,
              "step": 1,
              "label": {
                "en": "Port"
              }
            },
            {
              "id": "id",
              "type": "number",
              "value": 1,
              "step": 1,
              "attr": {
                "min": 0,
                "max": 50
              },
              "label": {
                "en": "Inverter ID"
              }
            }
          ]
        }
      ],
      "id": "soliswithbatt"
    }
  ],
  "capabilities": {
    "battery": {
      "type": "number",
      "title": {
        "en": "Battery"
      },
      "insights": false,
      "icon": "/assets/battery.svg",
      "units": {
        "en": "%"
      },
      "min": 0,
      "max": 100,
      "desc": {
        "en": "Battery charge in percentage (%)"
      },
      "chartType": "spline",
      "decimals": 2,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor"
    },
    "force_battery_charge_mode": {
      "type": "enum",
      "title": {
        "en": "Force battery charge mode is"
      },
      "getable": true,
      "setable": true,
      "uiComponent": "picker",
      "uiQuickAction": false,
      "values": [
        {
          "id": "-1",
          "title": {
            "en": "Unknown"
          }
        },
        {
          "id": "0",
          "title": {
            "en": "Self-use"
          }
        },
        {
          "id": "1",
          "title": {
            "en": "Peak shaving"
          }
        },
        {
          "id": "2",
          "title": {
            "en": "Charge"
          }
        },
        {
          "id": "3",
          "title": {
            "en": "Discharge"
          }
        },
        {
          "id": "4",
          "title": {
            "en": "Idle"
          }
        }
      ]
    },
    "force_charge_direction": {
      "type": "number",
      "title": {
        "en": "Force battery charge direction is"
      },
      "getable": true,
      "setable": false,
      "uiComponent": "sensor"
    },
    "force_charge_source": {
      "type": "number",
      "title": {
        "en": "Force battery charge source is"
      },
      "decimals": 0,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor"
    },
    "measure_current": {
      "type": "number",
      "title": {
        "en": "Current"
      },
      "units": {
        "en": "A"
      },
      "insights": true,
      "desc": {
        "en": "Electric current (A)"
      },
      "chartType": "stepLine",
      "decimals": 2,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor"
    },
    "measure_power": {
      "type": "number",
      "title": {
        "en": "Power"
      },
      "units": {
        "en": "W"
      },
      "insights": true,
      "desc": {
        "en": "Power in watt (W)"
      },
      "chartType": "stepLine",
      "decimals": 2,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor"
    },
    "measure_temperature": {
      "type": "number",
      "title": {
        "en": "Temperature"
      },
      "units": {
        "en": "°C"
      },
      "insights": true,
      "desc": {
        "en": "Temperature in degrees Celsius (°C)"
      },
      "decimals": 2,
      "chartType": "spline",
      "getable": true,
      "setable": false,
      "uiComponent": "sensor"
    },
    "measure_voltage": {
      "type": "number",
      "title": {
        "en": "Voltage"
      },
      "units": {
        "en": "V"
      },
      "desc": {
        "en": "Voltage (V)"
      },
      "insights": true,
      "chartType": "stepLine",
      "decimals": 2,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor"
    },
    "meter_power": {
      "type": "number",
      "title": {
        "en": "Total Yield"
      },
      "decimals": 2,
      "units": {
        "en": "kWh"
      },
      "desc": {
        "en": "Energy usage in kilowatt-hour (kWh)"
      },
      "chartType": "spline",
      "insights": true,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "icon": "/assets/total_yield.svg"
    },
    "operating_mode": {
      "type": "enum",
      "title": {
        "en": "Operating mode"
      },
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "uiQuickAction": false,
      "values": [
        {
          "id": "1",
          "title": {
            "en": "UPS"
          }
        },
        {
          "id": "2",
          "title": {
            "en": "Self use"
          }
        },
        {
          "id": "4",
          "title": {
            "en": "TOU Self use"
          }
        },
        {
          "id": "8",
          "title": {
            "en": "Feed in priority"
          }
        },
        {
          "id": "16",
          "title": {
            "en": "TOU Feed in priority"
          }
        },
        {
          "id": "32",
          "title": {
            "en": "Backup"
          }
        },
        {
          "id": "64",
          "title": {
            "en": "Off-grid"
          }
        },
        {
          "id": "128",
          "title": {
            "en": "Force battery charge mode"
          }
        },
        {
          "id": "256",
          "title": {
            "en": "Passive"
          }
        },
        {
          "id": "512",
          "title": {
            "en": "Reserved 9"
          }
        },
        {
          "id": "1024",
          "title": {
            "en": "Reserved 10"
          }
        },
        {
          "id": "2048",
          "title": {
            "en": "Reserved 11"
          }
        },
        {
          "id": "4096",
          "title": {
            "en": "Reserved 12"
          }
        },
        {
          "id": "8192",
          "title": {
            "en": "Reserved 13"
          }
        },
        {
          "id": "16384",
          "title": {
            "en": "Reserved 14"
          }
        },
        {
          "id": "32768",
          "title": {
            "en": "Reserved 15"
          }
        }
      ]
    },
    "passive_mode": {
      "type": "number",
      "title": {
        "en": "Passive mode is"
      },
      "getable": true,
      "setable": false,
      "uiComponent": "sensor"
    },
    "peak_shaving_max_grid_power": {
      "type": "number",
      "title": {
        "en": "Peak shaving max grid power"
      },
      "uiComponent": "slider",
      "getable": true,
      "setable": true,
      "units": {
        "en": "W"
      },
      "min": 0,
      "max": 10000,
      "step": 200
    },
    "peak_soc": {
      "type": "number",
      "title": {
        "en": "Peak SOC"
      },
      "units": {
        "en": "%"
      },
      "min": 0,
      "max": 100,
      "desc": {
        "en": "Peak shaving SOC in percentage (%)"
      },
      "chartType": "spline",
      "decimals": 0,
      "getable": true,
      "setable": true,
      "uiComponent": "slider"
    },
    "solis_model": {
      "type": "string",
      "title": {
        "en": "Model"
      },
      "getable": true,
      "setable": false
    },
    "solis_status": {
      "type": "string",
      "title": {
        "en": "Status"
      },
      "getable": true,
      "setable": false
    },
    "storage_control_mode": {
      "type": "number",
      "title": {
        "en": "Storage control mode"
      },
      "getable": true,
      "setable": false
    },
    "tou_slots": {
      "type": "number",
      "title": {
        "en": "TOU Slots Active"
      },
      "insights": false,
      "min": 0,
      "max": 100,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor"
    }
  }
}